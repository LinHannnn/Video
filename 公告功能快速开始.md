# 📢 公告功能快速开始指南

## 🚀 5分钟快速上手

### 1. 查看当前公告

```bash
curl http://localhost:3000/api/announcements/active
```

**输出**：
```json
{
  "code": 200,
  "msg": "获取成功",
  "data": [
    {
      "id": 1,
      "content": "🎉 欢迎使用视频解析小程序！",
      "priority": 10
    },
    {
      "id": 2,
      "content": "📢 登录后即可使用全部功能！",
      "priority": 5
    }
  ]
}
```

---

### 2. 创建新公告

```bash
curl -X POST http://localhost:3000/api/announcements \
  -H "Content-Type: application/json" \
  -d '{
    "content": "🎊 恭喜您成功创建第一条公告！",
    "status": 1,
    "priority": 20
  }'
```

**成功响应**：
```json
{
  "code": 200,
  "msg": "创建成功",
  "data": {
    "id": 3
  }
}
```

---

### 3. 更新公告

```bash
curl -X PUT http://localhost:3000/api/announcements/3 \
  -H "Content-Type: application/json" \
  -d '{
    "content": "🎊 这是更新后的公告内容！",
    "priority": 30
  }'
```

---

### 4. 禁用公告

```bash
curl -X POST http://localhost:3000/api/announcements/batch/status \
  -H "Content-Type: application/json" \
  -d '{
    "ids": [3],
    "status": 0
  }'
```

---

### 5. 删除公告

```bash
curl -X DELETE http://localhost:3000/api/announcements/3
```

---

## 📱 小程序效果

打开小程序首页，您将看到：

```
┌────────────────────────────────┐
│      视频提取助手              │
│  支持主流平台视频无水印下载    │
│                                │
│  📢 欢迎使用视频解析小程序！   │ ← 公告会自动滚动
│     支持抖音、快手、B站...     │
│                                │
│  [请粘贴视频链接...]           │
└────────────────────────────────┘
```

---

## 🎯 常用场景

### 场景1：发布系统通知

```bash
curl -X POST http://localhost:3000/api/announcements \
  -H "Content-Type: application/json" \
  -d '{
    "content": "⚠️ 系统将于今晚22:00进行维护，预计1小时",
    "status": 1,
    "priority": 100
  }'
```

### 场景2：发布活动信息

```bash
curl -X POST http://localhost:3000/api/announcements \
  -H "Content-Type: application/json" \
  -d '{
    "content": "🔥 双十一活动开始啦！全场功能免费使用！",
    "status": 1,
    "priority": 90,
    "start_time": "2025-10-10 00:00:00",
    "end_time": "2025-10-12 23:59:59"
  }'
```

### 场景3：发布使用提示

```bash
curl -X POST http://localhost:3000/api/announcements \
  -H "Content-Type: application/json" \
  -d '{
    "content": "💡 温馨提示：下载的视频仅供个人学习使用",
    "status": 1,
    "priority": 10
  }'
```

---

## 🔧 管理命令

### 查看所有公告（包括禁用的）

```bash
curl 'http://localhost:3000/api/announcements?page=1&limit=10'
```

### 只查看启用的公告

```bash
curl 'http://localhost:3000/api/announcements?status=1'
```

### 只查看禁用的公告

```bash
curl 'http://localhost:3000/api/announcements?status=0'
```

---

## 📊 数据库操作

### 直接插入公告

```sql
INSERT INTO announcements (content, status, priority) 
VALUES ('这是一条新公告', 1, 10);
```

### 查看所有公告

```sql
SELECT * FROM announcements ORDER BY priority DESC, created_at DESC;
```

### 启用/禁用公告

```sql
-- 启用
UPDATE announcements SET status = 1 WHERE id = 1;

-- 禁用
UPDATE announcements SET status = 0 WHERE id = 1;
```

---

## ⚡ 快捷操作脚本

### 创建 `add-announcement.sh`

```bash
#!/bin/bash
curl -X POST http://localhost:3000/api/announcements \
  -H "Content-Type: application/json" \
  -d "{
    \"content\": \"$1\",
    \"status\": 1,
    \"priority\": ${2:-10}
  }"
```

**使用**：
```bash
chmod +x add-announcement.sh
./add-announcement.sh "这是一条新公告" 20
```

---

## 🎨 自定义样式

### 修改公告背景色

编辑 `miniprogram/pages/home/home.wxss`：

```css
.announcement-section {
  /* 修改为橙色渐变 */
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  
  /* 或纯色背景 */
  background: #007aff;
}
```

### 修改滚动速度

编辑 `miniprogram/pages/home/home.wxml`：

```xml
<swiper 
  interval="3000"  <!-- 修改这个值：单位毫秒 -->
  duration="500"   <!-- 切换动画时长 -->
>
```

---

## 💡 小贴士

### 1. 公告优先级建议
- **100+**：紧急重要（红色）
- **50-99**：重要（橙色）
- **10-49**：普通（蓝色）
- **1-9**：次要（灰色）

### 2. 内容长度建议
- ✅ **最佳**：20-40字
- ⚠️ **可用**：40-80字
- ❌ **不推荐**：超过80字

### 3. 更新频率建议
- 不要频繁更新（影响用户体验）
- 一天最多更新2-3次
- 节假日可适当增加

---

## 🐛 问题排查

### 问题：公告不显示

**检查步骤**：
1. 后端服务是否启动
2. 数据库表是否存在
3. 公告状态是否为启用
4. 小程序是否正确调用接口

**解决命令**：
```bash
# 1. 检查服务
curl http://localhost:3000/api/announcements/active

# 2. 初始化数据库
node scripts/createAnnouncementsTable.js

# 3. 查看数据库
SELECT * FROM announcements WHERE status = 1;
```

---

## 📚 更多文档

- **滚动公告功能说明.md** - 完整功能文档
- **✅_滚动公告功能完成总结.md** - 功能总结

---

## 🎉 快速测试

复制以下命令快速体验：

```bash
# 1. 查看公告
curl http://localhost:3000/api/announcements/active

# 2. 创建公告
curl -X POST http://localhost:3000/api/announcements \
  -H "Content-Type: application/json" \
  -d '{"content":"🎊 测试公告","status":1,"priority":50}'

# 3. 再次查看
curl http://localhost:3000/api/announcements/active
```

---

**开始使用吧！** 🚀
