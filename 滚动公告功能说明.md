# ğŸ“¢ æ»šåŠ¨å…¬å‘ŠåŠŸèƒ½è¯´æ˜æ–‡æ¡£

## åŠŸèƒ½æ¦‚è¿°

å°ç¨‹åºé¦–é¡µæ–°å¢äº†æ»šåŠ¨å…¬å‘ŠåŠŸèƒ½ï¼Œå¯ä»¥åŠ¨æ€æ˜¾ç¤ºç³»ç»Ÿå…¬å‘Šæˆ–è¿è¥æ¶ˆæ¯ã€‚å…¬å‘Šå†…å®¹å®Œå…¨å¯é€šè¿‡åç«¯æ¥å£è‡ªå®šä¹‰ï¼Œæ”¯æŒæ— é™é•¿åº¦å†…å®¹ã€‚

---

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

1. **åŠ¨æ€åŠ è½½** - å…¬å‘Šå†…å®¹ä»åç«¯æ¥å£å®æ—¶è·å–
2. **æ— é™åˆ¶å†…å®¹** - æ”¯æŒä»»æ„é•¿åº¦çš„å…¬å‘Šæ–‡æœ¬
3. **è‡ªåŠ¨æ»šåŠ¨** - å¤šæ¡å…¬å‘Šè‡ªåŠ¨å‚ç›´æ»šåŠ¨åˆ‡æ¢
4. **ä¼˜å…ˆçº§æ’åº** - æ”¯æŒè®¾ç½®å…¬å‘Šä¼˜å…ˆçº§
5. **æ—¶é—´æ§åˆ¶** - å¯è®¾ç½®å…¬å‘Šçš„å¼€å§‹å’Œç»“æŸæ—¶é—´
6. **çŠ¶æ€ç®¡ç†** - æ”¯æŒå¯ç”¨/ç¦ç”¨å…¬å‘Š
7. **ç¾è§‚ç•Œé¢** - æ¸å˜è‰²èƒŒæ™¯ï¼Œç°ä»£åŒ–UIè®¾è®¡

---

## ğŸ¨ ç•Œé¢å±•ç¤º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¢ æ¬¢è¿ä½¿ç”¨è§†é¢‘è§£æå°ç¨‹åºï¼         â”‚  â† å…¬å‘Šå›¾æ ‡ + æ»šåŠ¨å†…å®¹
â”‚      æ”¯æŒæŠ–éŸ³ã€å¿«æ‰‹ã€Bç«™ç­‰...        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è®¾è®¡ç‰¹ç‚¹**ï¼š
- æ¸å˜ç´«è‰²èƒŒæ™¯ï¼ˆ`#667eea â†’ #764ba2`ï¼‰
- ç™½è‰²æ–‡å­—ï¼Œæ¸…æ™°æ˜“è¯»
- åœ†è§’è®¾è®¡ï¼Œç°ä»£ç¾è§‚
- è‡ªåŠ¨å‚ç›´æ»šåŠ¨

---

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„

### announcements è¡¨

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|------|--------|
| id | INT | å…¬å‘ŠIDï¼ˆä¸»é”®ï¼‰ | è‡ªå¢ |
| content | TEXT | å…¬å‘Šå†…å®¹ | å¿…å¡« |
| status | TINYINT | çŠ¶æ€ï¼š1å¯ç”¨ 0ç¦ç”¨ | 1 |
| priority | INT | ä¼˜å…ˆçº§ï¼ˆæ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼‰ | 0 |
| start_time | TIMESTAMP | å¼€å§‹æ—¶é—´ | NULL |
| end_time | TIMESTAMP | ç»“æŸæ—¶é—´ | NULL |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ | å½“å‰æ—¶é—´ |
| updated_at | TIMESTAMP | æ›´æ–°æ—¶é—´ | å½“å‰æ—¶é—´ |
| created_by | VARCHAR(100) | åˆ›å»ºäºº | NULL |

---

## ğŸ”Œ APIæ¥å£

### 1. è·å–æœ‰æ•ˆå…¬å‘Šï¼ˆå°ç¨‹åºç«¯ï¼‰

**æ¥å£åœ°å€**ï¼š`GET /api/announcements/active`

**è¯´æ˜**ï¼šè·å–å½“å‰æœ‰æ•ˆçš„å…¬å‘Šåˆ—è¡¨ï¼ˆè‡ªåŠ¨è¿‡æ»¤çŠ¶æ€ã€æ—¶é—´ï¼‰

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```bash
GET https://your-domain.com/api/announcements/active
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "content": "ğŸ‰ æ¬¢è¿ä½¿ç”¨è§†é¢‘è§£æå°ç¨‹åºï¼æ”¯æŒæŠ–éŸ³ã€å¿«æ‰‹ã€Bç«™ç­‰å¤šå¹³å°è§†é¢‘è§£æ",
      "priority": 10,
      "start_time": null,
      "end_time": null
    },
    {
      "id": 2,
      "content": "ğŸ“¢ ç™»å½•åå³å¯ä½¿ç”¨å…¨éƒ¨åŠŸèƒ½ï¼Œå¿«æ¥ä½“éªŒå§ï¼",
      "priority": 5,
      "start_time": null,
      "end_time": null
    }
  ]
}
```

### 2. è·å–æ‰€æœ‰å…¬å‘Šï¼ˆç®¡ç†ç«¯ï¼‰

**æ¥å£åœ°å€**ï¼š`GET /api/announcements`

**è¯·æ±‚å‚æ•°**ï¼š
- `page`ï¼ˆå¯é€‰ï¼‰ï¼šé¡µç ï¼Œé»˜è®¤1
- `limit`ï¼ˆå¯é€‰ï¼‰ï¼šæ¯é¡µæ•°é‡ï¼Œé»˜è®¤10
- `status`ï¼ˆå¯é€‰ï¼‰ï¼šçŠ¶æ€ç­›é€‰ï¼Œ0æˆ–1

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```bash
GET https://your-domain.com/api/announcements?page=1&limit=10&status=1
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "è·å–æˆåŠŸ",
  "data": {
    "list": [...],
    "total": 10,
    "page": 1,
    "limit": 10
  }
}
```

### 3. åˆ›å»ºå…¬å‘Š

**æ¥å£åœ°å€**ï¼š`POST /api/announcements`

**è¯·æ±‚ä½“**ï¼š
```json
{
  "content": "ğŸ‰ åŒåä¸€æ´»åŠ¨å¼€å§‹å•¦ï¼å…¨åœºè§†é¢‘è§£æå…è´¹ä½¿ç”¨ï¼",
  "status": 1,
  "priority": 100,
  "start_time": "2025-10-10 00:00:00",
  "end_time": "2025-10-12 23:59:59",
  "created_by": "admin"
}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 3
  }
}
```

### 4. æ›´æ–°å…¬å‘Š

**æ¥å£åœ°å€**ï¼š`PUT /api/announcements/:id`

**è¯·æ±‚ä½“**ï¼š
```json
{
  "content": "æ›´æ–°åçš„å…¬å‘Šå†…å®¹",
  "status": 1,
  "priority": 50
}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "æ›´æ–°æˆåŠŸ"
}
```

### 5. åˆ é™¤å…¬å‘Š

**æ¥å£åœ°å€**ï¼š`DELETE /api/announcements/:id`

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "åˆ é™¤æˆåŠŸ"
}
```

### 6. æ‰¹é‡æ›´æ–°çŠ¶æ€

**æ¥å£åœ°å€**ï¼š`POST /api/announcements/batch/status`

**è¯·æ±‚ä½“**ï¼š
```json
{
  "ids": [1, 2, 3],
  "status": 0
}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "æ›´æ–°æˆåŠŸ",
  "data": {
    "affectedRows": 3
  }
}
```

---

## ğŸ’» ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šåˆ›å»ºä¸€æ¡ç®€å•å…¬å‘Š

```bash
curl -X POST http://localhost:3000/api/announcements \
  -H "Content-Type: application/json" \
  -d '{
    "content": "æ¬¢è¿ä½¿ç”¨æœ¬æœåŠ¡ï¼",
    "status": 1,
    "priority": 10
  }'
```

### ç¤ºä¾‹2ï¼šåˆ›å»ºé™æ—¶å…¬å‘Š

```bash
curl -X POST http://localhost:3000/api/announcements \
  -H "Content-Type: application/json" \
  -d '{
    "content": "ğŸ”¥ åŒåä¸€æ´»åŠ¨è¿›è¡Œä¸­ï¼",
    "status": 1,
    "priority": 100,
    "start_time": "2025-10-10 00:00:00",
    "end_time": "2025-10-12 23:59:59"
  }'
```

### ç¤ºä¾‹3ï¼šç¦ç”¨å…¬å‘Š

```bash
curl -X PUT http://localhost:3000/api/announcements/1 \
  -H "Content-Type: application/json" \
  -d '{
    "status": 0
  }'
```

### ç¤ºä¾‹4ï¼šæ‰¹é‡ç¦ç”¨å¤šä¸ªå…¬å‘Š

```bash
curl -X POST http://localhost:3000/api/announcements/batch/status \
  -H "Content-Type: application/json" \
  -d '{
    "ids": [1, 2, 3],
    "status": 0
  }'
```

---

## ğŸ› ï¸ ç®¡ç†å‘½ä»¤

### åˆå§‹åŒ–å…¬å‘Šè¡¨

```bash
cd /home/devbox/project/Video
node scripts/createAnnouncementsTable.js
```

### ç›´æ¥æ’å…¥å…¬å‘Šï¼ˆSQLï¼‰

```sql
-- æ’å…¥ä¸€æ¡æ–°å…¬å‘Š
INSERT INTO announcements (content, status, priority) 
VALUES ('è¿™æ˜¯ä¸€æ¡æ–°å…¬å‘Š', 1, 10);

-- æŸ¥çœ‹æ‰€æœ‰å…¬å‘Š
SELECT * FROM announcements ORDER BY priority DESC;

-- å¯ç”¨å…¬å‘Š
UPDATE announcements SET status = 1 WHERE id = 1;

-- ç¦ç”¨å…¬å‘Š
UPDATE announcements SET status = 0 WHERE id = 1;

-- åˆ é™¤å…¬å‘Š
DELETE FROM announcements WHERE id = 1;
```

---

## ğŸ“± å‰ç«¯å®ç°

### 1. é¡µé¢ç»“æ„ï¼ˆhome.wxmlï¼‰

```xml
<!-- æ»šåŠ¨å…¬å‘Š -->
<view wx:if="{{announcements.length > 0}}" class="announcement-section">
  <view class="announcement-icon">ğŸ“¢</view>
  <swiper 
    class="announcement-swiper" 
    vertical="true" 
    autoplay="true" 
    circular="true" 
    interval="3000" 
    duration="500"
  >
    <block wx:for="{{announcements}}" wx:key="id">
      <swiper-item>
        <view class="announcement-item">{{item.content}}</view>
      </swiper-item>
    </block>
  </swiper>
</view>
```

### 2. æ ·å¼å®šä¹‰ï¼ˆhome.wxssï¼‰

```css
/* æ»šåŠ¨å…¬å‘Š */
.announcement-section {
  width: 100%;
  max-width: 600rpx;
  height: 70rpx;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 16rpx;
  display: flex;
  align-items: center;
  padding: 0 24rpx;
  margin-bottom: 40rpx;
  box-shadow: 0 4rpx 12rpx rgba(102, 126, 234, 0.25);
  overflow: hidden;
}
```

### 3. é€»è¾‘å¤„ç†ï¼ˆhome.jsï¼‰

```javascript
// åŠ è½½å…¬å‘Š
async loadAnnouncements() {
  try {
    const result = await api.getAnnouncements()
    if (result.code === 200 && result.data) {
      this.setData({
        announcements: result.data
      })
    }
  } catch (error) {
    console.error('åŠ è½½å…¬å‘Šå¤±è´¥:', error)
  }
}
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. ç³»ç»Ÿé€šçŸ¥
```
"ğŸ“¢ ç³»ç»Ÿå°†äºä»Šæ™š22:00è¿›è¡Œç»´æŠ¤ï¼Œé¢„è®¡è€—æ—¶1å°æ—¶"
```

### 2. åŠŸèƒ½æ›´æ–°
```
"ğŸ‰ æ–°å¢æ”¯æŒå°çº¢ä¹¦å¹³å°è§†é¢‘è§£æï¼"
```

### 3. æ´»åŠ¨å®£ä¼ 
```
"ğŸ”¥ åŒåä¸€æ´»åŠ¨è¿›è¡Œä¸­ï¼å…¨åœºåŠŸèƒ½å…è´¹ä½¿ç”¨ï¼"
```

### 4. ä½¿ç”¨æç¤º
```
"ğŸ’¡ æ¸©é¦¨æç¤ºï¼šè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œä»…ä¾›ä¸ªäººå­¦ä¹ ä½¿ç”¨"
```

### 5. æœåŠ¡çŠ¶æ€
```
"âš ï¸ éƒ¨åˆ†å¹³å°æ¥å£å¼‚å¸¸ï¼Œæˆ‘ä»¬æ­£åœ¨ç´§æ€¥ä¿®å¤ä¸­..."
```

---

## ğŸ“‹ æœ€ä½³å®è·µ

### 1. å†…å®¹é•¿åº¦
- âœ… æ¨èï¼š30-50å­—ï¼Œä¸€è¡Œæ˜¾ç¤ºå®Œæ•´
- âš ï¸ å¯ç”¨ï¼š50-100å­—ï¼Œå¯å®Œæ•´å±•ç¤º
- âŒ ä¸æ¨èï¼šè¶…è¿‡100å­—ï¼Œå½±å“ç”¨æˆ·ä½“éªŒ

### 2. ä¼˜å…ˆçº§è®¾ç½®
- **100+**ï¼šé‡è¦ç´§æ€¥å…¬å‘Šï¼ˆç³»ç»Ÿç»´æŠ¤ã€é‡å¤§åŠŸèƒ½å˜æ›´ï¼‰
- **50-99**ï¼šé‡è¦å…¬å‘Šï¼ˆæ´»åŠ¨é€šçŸ¥ã€åŠŸèƒ½ä¸Šçº¿ï¼‰
- **10-49**ï¼šæ™®é€šå…¬å‘Šï¼ˆä½¿ç”¨æç¤ºã€æ¸©é¦¨æé†’ï¼‰
- **1-9**ï¼šæ¬¡è¦å…¬å‘Šï¼ˆå…¶ä»–ä¿¡æ¯ï¼‰

### 3. æ—¶é—´æ§åˆ¶
- é™æ—¶æ´»åŠ¨ï¼šè®¾ç½® `start_time` å’Œ `end_time`
- é•¿æœŸå…¬å‘Šï¼šæ—¶é—´å­—æ®µç•™ç©º
- å®šæ—¶å‘å¸ƒï¼šè®¾ç½®æœªæ¥çš„ `start_time`

### 4. å†…å®¹è§„èŒƒ
- ä½¿ç”¨ emoji å¢åŠ è§†è§‰å¸å¼•åŠ›
- æ–‡å­—ç®€æ´æ˜äº†
- é¿å…è¿‡äºå†—é•¿
- çªå‡ºå…³é”®ä¿¡æ¯

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šå…¬å‘Šä¸æ˜¾ç¤º

**å¯èƒ½åŸå› **ï¼š
1. åç«¯æœåŠ¡æœªå¯åŠ¨
2. æ•°æ®åº“è¿æ¥å¤±è´¥
3. å…¬å‘ŠçŠ¶æ€ä¸ºç¦ç”¨
4. å…¬å‘Šæ—¶é—´ä¸åœ¨æœ‰æ•ˆæœŸå†…

**è§£å†³æ–¹æ³•**ï¼š
```bash
# 1. æ£€æŸ¥åç«¯æœåŠ¡
curl http://localhost:3000/api/announcements/active

# 2. æ£€æŸ¥æ•°æ®åº“
node scripts/createAnnouncementsTable.js

# 3. æŸ¥çœ‹æ•°æ®åº“è®°å½•
SELECT * FROM announcements WHERE status = 1;
```

### é—®é¢˜2ï¼šå…¬å‘Šæ»šåŠ¨ä¸æµç•…

**è§£å†³æ–¹æ³•**ï¼š
- è°ƒæ•´ `interval` å’Œ `duration` å‚æ•°
- å‡å°‘å…¬å‘Šæ•°é‡ï¼ˆå»ºè®®ä¸è¶…è¿‡10æ¡ï¼‰
- ä¼˜åŒ–å…¬å‘Šå†…å®¹é•¿åº¦

### é—®é¢˜3ï¼šå…¬å‘Šå†…å®¹è¶…é•¿

**è§£å†³æ–¹æ³•**ï¼š
1. ç²¾ç®€å†…å®¹
2. æ‹†åˆ†ä¸ºå¤šæ¡å…¬å‘Š
3. åœ¨æ ·å¼ä¸­è®¾ç½® `text-overflow: ellipsis`

---

## ğŸ“Š æ•°æ®ç»Ÿè®¡

### æŸ¥è¯¢å…¬å‘Šç»Ÿè®¡

```sql
-- æ€»å…¬å‘Šæ•°
SELECT COUNT(*) as total FROM announcements;

-- å¯ç”¨å…¬å‘Šæ•°
SELECT COUNT(*) as active FROM announcements WHERE status = 1;

-- ä»Šæ—¥æ–°å¢å…¬å‘Š
SELECT COUNT(*) as today 
FROM announcements 
WHERE DATE(created_at) = CURDATE();

-- ä¼˜å…ˆçº§åˆ†å¸ƒ
SELECT 
  CASE 
    WHEN priority >= 100 THEN 'é«˜ä¼˜å…ˆçº§'
    WHEN priority >= 50 THEN 'ä¸­ä¼˜å…ˆçº§'
    WHEN priority >= 10 THEN 'æ™®é€š'
    ELSE 'ä½ä¼˜å…ˆçº§'
  END as level,
  COUNT(*) as count
FROM announcements
WHERE status = 1
GROUP BY level;
```

---

## ğŸ‰ æ€»ç»“

æ»šåŠ¨å…¬å‘ŠåŠŸèƒ½å·²æˆåŠŸé›†æˆåˆ°å°ç¨‹åºé¦–é¡µï¼Œå…·å¤‡ä»¥ä¸‹ä¼˜åŠ¿ï¼š

âœ… **å®Œå…¨å¯æ§** - é€šè¿‡APIæ¥å£çµæ´»ç®¡ç†  
âœ… **æ— é™åˆ¶å†…å®¹** - æ”¯æŒä»»æ„é•¿åº¦æ–‡æœ¬  
âœ… **ç¾è§‚å¤§æ–¹** - ç°ä»£åŒ–UIè®¾è®¡  
âœ… **æ˜“äºä½¿ç”¨** - ç®€å•çš„APIæ¥å£  
âœ… **åŠŸèƒ½å®Œå–„** - ä¼˜å…ˆçº§ã€æ—¶é—´æ§åˆ¶ã€çŠ¶æ€ç®¡ç†  

---

**æ–‡æ¡£æ›´æ–°æ—¶é—´**ï¼š2025-10-05  
**ç‰ˆæœ¬**ï¼šv1.0.0
